# Следующие шаги

## Текущий этап: Фаза 2, Шаг 2.1

### Фаза 2: AI-парсинг сообщений

**Цель фазы:** Реализовать парсинг текстовых сообщений с помощью OpenAI API для извлечения данных о сменах.

---

### Шаг 2.1: Создание модуля parser.py

**Задача:** Создать функцию для отправки запросов в OpenAI и парсинга сообщений пользователя.

**Что нужно сделать:**

1. Создать файл `parser.py` в корне проекта

2. Реализовать функцию `parse_shift_message()`:
   - Принимает: сообщение, текущую дату, базовые часы, список услуг
   - Отправляет промпт в OpenAI API (модель gpt-4o-mini)
   - Возвращает: JSON с полями date, start_time, end_time, services, confidence, missing_fields

3. Настроить обработку ошибок:
   - Если API недоступен - вернуть структуру с ошибкой
   - Убирать markdown из ответа если есть

4. Протестировать парсинг с примерами:
   - "Смена 07:00 до 23:00 + обед + ронин"
   - "Вчера работал с 9 до 18"
   - "Работал до вечера" (недостаточно данных)

**После выполнения:**
- Протестировать с test_parser.py
- Обновить STATUS.md
- Сделать коммит: "Шаг 2.1: Модуль AI-парсинга"
- Перейти к Шагу 2.2

---

### Следующие шаги Фазы 2:

**Шаг 2.2:** Обработка текстовых сообщений
- Создать handlers/shifts.py
- Бот реагирует на текстовые сообщения
- Показывает карточку подтверждения

**Шаг 2.3:** Таблица shifts в БД
- Добавить таблицу shifts
- Функции create_shift(), confirm_shift()

**Шаг 2.4:** Сохранение подтверждённой смены
- Обработка кнопок подтверждения/отмены
- Сохранение в БД

**Время на Фазу 2:** ~3 дня